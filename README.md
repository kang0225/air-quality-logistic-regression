# 📈 서울시 대기질 예측을 위한 로지스틱 회귀 분석 프로젝트 📈

![Python](https://img.shields.io/badge/Python-3.12-blue.svg)
![Pandas](https://img.shields.io/badge/Pandas-2.x-yellow.svg)
![Scikit-learn](https://img.shields.io/badge/Scikit--learn-1.x-orange.svg)

## 📖 프로젝트 개요 📖

본 프로젝트는 서울시의 대기오염 및 기상 데이터를 활용하여 다음 날의 초미세먼지(PM2.5) 및 미세먼지(PM10) 농도를 '좋음' 또는 '나쁨'으로 예측하는 머신러닝 모델을 개발하고 성능을 다양한 지표를 활용하여 분석하는 것을 목표로 합니다.

특히, 공중 보건에 치명적인 **'나쁨' 단계를 '좋음'으로 잘못 예측하는 경우(False Negative)를 최소화**하는 데 중점을 두었습니다. 이를 위해 데이터 전처리, 특성 공학, 클래스 불균형 문제 해결, 모델 성능 평가에 이르는 전 과정을 체계적으로 수행했습니다.

프로젝트 관련 상세 설명은 아래 세 개의 주피터 노트북으로 구성되어 있습니다:
1.  [preprocessing.ipynb](https://colab.research.google.com/github/kang0225/air-quality-logistic-regression/blob/main/notebooks/preprocessing.ipynb) : 대기오염 및 기상 데이터를 정제하고 병합합니다.
2.  [training.ipynb](https://colab.research.google.com/github/kang0225/air-quality-logistic-regression/blob/main/notebooks/training.ipynb) : 예측 모델을 위한 머신러닝 파이프라인을 구축하고 훈련시킵니다.
3.  [evaluating.ipynb](https://colab.research.google.com/github/kang0225/air-quality-logistic-regression/blob/main/notebooks/evaluating.ipynb) : 핵심 분류 지표를 통해 모델의 성능을 분석하고 평가합니다.

---

## ⚙️ 프로젝트 워크플로우 ⚙️

### ① 데이터 전처리 (`preprocessing.ipynb`)

모델링에 적합한 학습용 데이터셋을 만들기 위해 서울시 공공데이터와 기상청 데이터를 정제하는 과정입니다.

-   **데이터 불러오기**: 2023년부터 2025년까지 3개년 간의 서울시 대기오염 데이터와 기상 데이터를 로드했습니다.
-   **컬럼명 표준화**: 한글 컬럼명을 영문으로 변경하여 데이터 처리의 편의성을 높였습니다.
-   **결측치 처리**: `ffill().bfill()`을 사용하여 시계열 데이터의 특성을 유지하며 결측치를 앞뒤 값으로 채웠습니다.
-   **데이터 병합**: 전처리된 대기오염 데이터와 기상 데이터를 `date` 컬럼 기준으로 **Inner Join**하여 하나의 데이터프레임으로 통합했습니다.
-   **데이터 필터링**: 서울의 중심 지역인 '강남구'의 데이터만을 추출하여 분석을 진행했습니다.

#### 출처
- [서울시공공데이터](https://data.seoul.go.kr/dataList/OA-15488/S/1/datasetView.do)
- [기상자료개방포털](https://data.kma.go.kr/data/grnd/selectAsosRltmList.do?pgmNo=36)
<br><br>


### ② 모델 훈련 및 파이프라인 구축 (`training.ipynb`)

다음 날의 대기질을 예측하기 위한 머신러닝 파이프라인을 구축했습니다. 초미세먼지(PM2.5)와 미세먼지(PM10)에 대해 각각의 모델을 생성했습니다.

-   **타겟 컬럼 생성**: 다음 날의 대기질을 예측하기 위해 `shift(-1)` 함수를 사용하여 타겟 변수를 생성했습니다. '나쁨'(1)으로 분류되는 기준은 다음과 같습니다:
    -   초미세먼지(PM2.5) 농도 ≥ 36 µg/m³
    -   미세먼지(PM10) 농도 ≥ 81 µg/m³
-   **특성 공학**: `PolynomialFeatures` (2차 다항)를 사용하여 특성 간의 상호작용을 학습할 수 있도록 했습니다.
-   **데이터 스케일링**: `StandardScaler`를 적용하여 모든 특성을 표준화했습니다.
-   **모델 선정**: `LogisticRegressionCV`를 사용하여 로지스틱 회귀와 시계열 교차 검증을 동시에 수행하고, 최적의 규제 강도를 탐색했습니다.
    -   **시계열 교차 검증**: 데이터의 시간 순서를 유지하기 위해 `TimeSeriesSplit`을 교차 검증 방식으로 채택했습니다.

#### 클래스 불균형 처리

대기질 데이터에서 '나쁨' 클래스는 극소수로 존재하기 때문에, 이 문제를 해결하기 위해 두 가지 전략을 사용했습니다.

1.  **초미세먼지(PM2.5) 모델 (SMOTEENN)**: **SMOTEENN** 기법을 파이프라인에 추가했습니다. 이는 소수 클래스를 오버샘플링(Over-sampling)하는 SMOTE와 다수 클래스의 노이즈를 제거하는 ENN(Edited Nearest Neighbors)을 결합한 방식으로, FN 케이스를 최소화하는 데 효과적이었습니다.
2.  **미세먼지(PM10) 모델 (클래스 가중치 & ElasticNet)**: `class_weight='balanced'` 옵션을 사용하여 소수 클래스의 수에 역수를 취해 더 많은 가중치를 주도록 했습니다. 또한, 과적합을 방지하고 모델 성능을 강화하기 위해 **ElasticNet 규제**를 적용했습니다.

---

## ③ 성능 평가 (`evaluating.ipynb`)

훈련된 모델이 실제 데이터에 얼마나 효과적인지 검증하기 위해 훈련 세트와 테스트 세트 모두에서 종합적인 성능 평가를 수행했습니다. '나쁨' 클래스에 대한 재현율(Recall)을 핵심 성공 지표로 삼았습니다.

### 초미세먼지(PM2.5) 모델 성능 분석

| **데이터셋** | **정확도(Accuracy)** | **정밀도(Precision)** | **재현율(Recall)** | **F1-점수(F1-score)** |
| :---------- | :------------------: | :-------------------: | :----------------: | :-------------------: |
| **훈련 세트** |         88%          |          34%          |      **91%** |          49%          |
| **테스트 세트** |         79%          |          33%          |      **80%** |          47%          |

-   **결론**: 이 모델은 **실용적 활용 가치가 높다**고 판단됩니다. 정밀도는 낮아 '좋음'을 '나쁨'으로 예측하는 경우가 많지만, 테스트 데이터에서 실제 '나쁨'인 날의 80%를 정확히 예측해냈습니다. 보건 및 건강에 직결되는 치명적 문제를 놓치지 않는 것이 더 중요하므로, 이는 매우 안정적이고 의미 있는 결과입니다.

### 미세먼지(PM10) 모델 성능 분석

| **데이터셋** | **정확도(Accuracy)** | **정밀도(Precision)** | **재현율(Recall)** | **F1-점수(F1-score)** |
| :---------- | :------------------: | :-------------------: | :----------------: | :-------------------: |
| **훈련 세트** |         90%          |          24%          |     **100%** |          39%          |
| **테스트 세트** |         76%          |          10%          |     **100%** |          18%          |

-   **결론**: 이 모델은 **실용성이 매우 떨어져** 신뢰하기 어렵습니다. 재현율은 100%로 완벽했지만, 이는 극도로 낮은 정밀도(10점)와 심한 과적합을 야기했습니다. 너무 많은 거짓 정보를 발생시키므로 실제 예측에 사용하기에는 부적합하다고 판단했습니다.

---

## 💡 최종 결론 및 향후 과제 💡

본 프로젝트를 통해 초미세먼지(PM2.5) 예측에 있어 높은 재현율을 달성하는 실용적인 로지스틱 회귀 모델을 성공적으로 개발했습니다.

하지만 미세먼지(PM10) 모델의 한계는 로지스틱 회귀가 이 문제에 최적의 솔루션이 아닐 수 있음을 시사합니다. 따라서 로지스틱 회귀 모델을 **XGBoost, LightGBM, RandomForest**와 같은 트리 기반 앙상블 모델로 대체하면 성능이 개선될 것으로 기대됩니다.

트리 기반 앙상블 모델은 로지스틱 회귀와 같은 선형 모델과 달리, 데이터 내의 복잡한 비선형 관계와 특성 간의 상호작용을 더 효과적으로 학습할 수 있습니다. 이를 통해, 본 프로젝트의 미세먼지(PM10) 모델이 겪었던 과적합 문제를 완화하고, 재현율(Recall)을 높은 수준으로 유지하면서도 FN(False Positive)을 줄여 정밀도(Precision)를 개선할 수 있을 것입니다.

결론적으로, 더 정교한 모델을 도입함으로써 실제 활용 가치가 있는 신뢰도 높은 대기질 예측 시스템을 구축할 수 있을 것으로 전망됩니다.

